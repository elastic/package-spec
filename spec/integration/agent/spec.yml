spec:
  additionalContents: false
  contents:
    - description: Folder containing input definitions
      type: folder
      name: input
      required: true
      additionalContents: false
      contents:
        - description: |
            Config template file for inputs defined in the policy_templates section of the top level manifest.
            The template should use standard Handlebars syntax (e.g., `{{vars.key}}`, `{{#if vars.condition}}`,
            `{{#each vars.items}}`) and must compile to valid YAML.
            Available Handlebars helpers include: 
            - `contains` (checks if item is in array/string), 
            - `escape_string` (wraps string in single quotes and escapes them), 
            - `escape_multiline_string` (escapes multiline strings without wrapping), 
            - `to_json` (converts object to JSON string), and 
            - `url_encode` (URI encodes string).
            Available meta variables include:
            - _meta.package.name, _meta.package.title, _meta.package.version
            - _meta.stream.id, _meta.stream.data_stream.dataset, _meta.stream.data_stream.type
            - _meta.input.id
            Check the Fleet implementation for the updated list of available helpers and variables:
            https://github.com/elastic/kibana/blob/70749d9216d7a5de6ce1e7a028d153d5390ad3ac/x-pack/platform/plugins/shared/fleet/server/services/epm/agent/agent.ts#L1).
          type: file
          sizeLimit: 2MB
          pattern: '^.+\.yml\.hbs$'
          required: true
          allowLink: true
